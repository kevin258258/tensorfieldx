---
title: "分析力学 Note 2.1: 位形空间"
description: "从双摆的甜甜圈说起：流形、切空间的两种视角以及广义速度的几何本质。"
pubDate: 2026-01-08
tags: ["Physics", "Differential Geometry", "Manifold", "Tangent Space"]
series: "Analytical Mechanics"
seriesOrder: 3
---

import Sidenote from '../../components/Sidenote.astro';
import Figure from '../../components/Figure.astro';

## 1. 什么是位形空间?

在 Note 1 中我们直接引入了广义坐标 $q$。但物理上，$q$ 到底生活在一个什么样的空间里？

考虑一个平面上的双摆。
* 第一根杆的状态由角度 $\theta_1 \in [0, 2\pi)$ 决定，这是一个圆 $S^1$。
* 第二根杆的状态由角度 $\theta_2 \in [0, 2\pi)$ 决定，这也是一个圆 $S^1$。

系统的整体状态由 $(\theta_1, \theta_2)$ 唯一确定。这意味着该系统的**位形空间** $Q$ 是两个圆的笛卡尔积：
$$
Q = S^1 \times S^1 = T^2
$$
这就形成了一个**环面**，也就是一个甜甜圈的表面。

**定义**：一个物理系统的**位形空间** $Q$ 是该系统所有可能状态的集合。在数学上，$Q$ 通常是一个**微分流形**。

<Sidenote>
  **为什么要引入流形？** 
  因为对于像双摆这样的系统，我们无法用单一的全局坐标系覆盖整个空间（比如角度 $\theta$ 在 $0$ 和 $2\pi$ 处的跳变）。流形允许我们把空间局部看作平直的欧几里得空间 $\mathbb{R}^n$，从而可以使用微积分工具，同时保留整体的拓扑结构。
</Sidenote>

## 2. 切向量：运动的几何

有了空间，我们还需要描述运动。运动对应于速度，而速度在几何上就是**切向量**。

设 $\gamma: (-\epsilon, \epsilon) \to M$ 是流形上的一条光滑曲线（代表系统的运动轨迹），且 $\gamma(0) = z_0$。曲线在 $z_0$ 处的**切向量** $v$ 定义为：

$$
v = \frac{d}{dt}\gamma(t)\bigg|_{t=0}
$$

所有经过 $z_0$ 点的曲线的切向量组成了该点的**切空间 (Tangent Space)**，记为 $T_{z_0}M$。

对于具体如何计算这个空间，我们有两种截然不同但等价的视角：**隐式视角**（约束方程）和**参数化视角**（广义坐标）。

## 3. 视角一：隐式定义 (The Implicit View)

这是“做减法”的视角：我们从大的环境空间 $\mathbb{R}^n$ 中，通过 $k$ 个约束方程切出维数为 $n-k$ 的流形。

设流形 $M$ 由方程 $F(z) = \mathbf{0}$ 定义，其中 $F: \mathbb{R}^n \to \mathbb{R}^k$。

### 定理 1：切空间是雅可比的核

如果 $DF(z_0)$ 是满射（即约束独立），则切空间是雅可比矩阵的**核**：

$$
T_{z_0}M = \ker[DF(z_0)]
$$

这意味着：
$$
[DF(z_0)] \cdot v = \mathbf{0} \implies \nabla F_i(z_0) \cdot v = 0
$$
即切向量必须**垂直于**所有约束方程的梯度。

> **Prove**
>
> 1.  **包含关系 ($\subseteq$)**：
>     设 $v$ 是任意切向量，对应曲线 $\gamma(t)$。由于曲线在流形上，恒有 $F(\gamma(t)) = \mathbf{0}$。
>     对两边求导：
>     $$ \frac{d}{dt} F(\gamma(t)) \bigg|_{t=0} = [DF(\gamma(0))] \cdot \gamma'(0) = [DF(z_0)] \cdot v = \mathbf{0} $$
>     故 $v \in \ker[DF(z_0)]$。
>
> 2.  **维数相等 ($\dim = \dim$)**：
>     根据隐函数定理，流形维数为 $n-k$。
>     根据秩-零化度定理：$\dim(\ker) = n - \text{rank}(DF) = n - k$。
>     子空间维数等于全空间维数，故两者相等。$\blacksquare$

### 例子：球面
对于单位球 $x^2+y^2+z^2-1=0$，梯度为 $\nabla F = (2x, 2y, 2z)^T$。定理告诉我们，切平面上的任何向量 $v$ 必须满足 $(x,y,z) \cdot v = 0$，即切线垂直于半径。

## 4. 视角二：参数化定义

这是做加法的视角，也是广义坐标的视角。我们用参数 $u$ 去生成流形。

设 $\Phi: U \to \mathbb{R}^n$ 是流形的局部参数化映射，其中 $U \subset \mathbb{R}^{n-k}$。这里的参数 $u$ 其实就是我们的**广义坐标** $q$。

### 定理 2：切空间是雅可比的像

切空间是映射 $\Phi$ 的雅可比矩阵的**像 (Image)**：

$$
T_{\Phi(u)}M = \text{img}[D\Phi(u)]
$$

这意味着，切空间是由雅可比矩阵的列向量张成的。

> **证明**
>
> 1.  **包含关系 ($\supseteq$)**：
>     在参数空间取任意向量 $w$，构造直线 $c(t) = u + tw$。映射到流形上变为曲线 $\gamma(t) = \Phi(u+tw)$。
>     其切向量为 $v = \frac{d}{dt}\Phi(u+tw) = [D\Phi(u)] \cdot w$。
>     这意味着像空间中的任一向量都是合法的切向量。
>
> 2.  **维数相等**：
>     流形维数与参数个数相同，均为 $m$。
>     对于正则参数化，雅可比矩阵列满秩，像空间维数也是 $m$。证毕。$\blacksquare$

## 5. 广义速度的几何

结合上述定理，我们可以从几何角度重新审视分析力学中的坐标变换。

如果我们令参数 $u$ 为广义坐标 $q$，那么映射 $\Phi$ 就是从广义坐标到笛卡尔坐标的变换：$z = \Phi(q)$。

根据定理 2，笛卡尔空间中的速度 $v$ (即 $\dot{z}$) 与广义速度 $\dot{q}$ 的关系为：

$$
v = [D\Phi(q)] \cdot \dot{q}
$$
(这里我们暂时省略显含时间 $t$ 的情况，即 $\Phi(q)$ 而非 $\Phi(q,t)$)

这说明：**雅可比矩阵 $J = D\Phi$ 将广义速度线性映射为笛卡尔速度。**

### 例子：螺旋线
考虑参数化 $\gamma(t) = (\cos t, \sin t, t)^T$。
雅可比矩阵为：
$$
J = \begin{pmatrix} -\sin t \\ \cos t \\ 1 \end{pmatrix}
$$
切空间是一维的，由向量 $(-\sin t, \cos t, 1)^T$ 张成。这正是粒子沿螺旋线运动的瞬时方向。

### 例子：球坐标系
参数化 $\Phi(\theta, \phi) = (R\sin\theta\cos\phi, \dots)^T$。
雅可比矩阵有两列，分别对应 $\theta$ 方向和 $\phi$ 方向的切向量 $\mathbf{e}_\theta, \mathbf{e}_\phi$。
$$
v = \dot{\theta}\mathbf{e}_\theta + \dot{\phi}\mathbf{e}_\phi
$$
任意切向量（速度）都是这两个基向量的线性组合。

---

**总结**：
*   **位形空间**是描述系统的几何舞台（流形）。
*   **隐式视角** ($F(z)=0$) 告诉我们切向量**不能**去哪（垂直于梯度，$\ker DF$）。
*   **参数化视角** ($z=\Phi(q)$) 告诉我们切向量**能**怎么构造（基向量的组合，$\text{img} D\Phi$）。
*   **广义速度** $\dot{q}$ 就是参数空间的速度，通过雅可比矩阵推以前方，变成了流形上的实际速度。